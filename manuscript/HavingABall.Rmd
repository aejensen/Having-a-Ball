---
title: "Having a Ball: evaluating scoring streaks and game excitement using in-match trend estimation"
author: | 
  | Claus Thorn Ekstr√∏m and Andreas Kryger Jensen
  | Biostatistics, Institute of Public Health, University of Copenhagen
  | ekstrom@sund.ku.dk, aeje@sund.ku.dk
date: "`r format(Sys.time(), '%d %B, %Y')`"
fontsize: 11pt  
header-includes:
  - \usepackage{bm}
  - \usepackage{amssymb}
  - \usepackage[labelfont=bf]{caption}
  - \DeclareMathOperator*{\argsup}{arg\,sup}  
  - \DeclareMathOperator*{\argmin}{arg\,min}  
  - \DeclareMathOperator*{\E}{E}
  - \DeclareMathOperator*{\Cov}{Cov}
  - \DeclareMathOperator*{\Cor}{Cor}
  - \DeclareMathOperator*{\Var}{Var}
  - \DeclareMathOperator*{\Erf}{Erf}
  - \DeclareMathOperator*{\Erfc}{Erfc}
  - \usepackage{multirow}
  - \usepackage{float}
  - \floatstyle{plaintop}
  - \restylefloat{table}
  - \usepackage[amsthm,thmmarks]{ntheorem}
  - \newtheorem{definition}{Definition}
  - \newtheorem{assumption}{Assumption}
  - \newtheorem{proposition}{Proposition}
  - \theoremstyle{nonumberplain}
  - \newtheorem{Proof}{Proof}
  - \usepackage{xcolor}
  - \newcommand{\revision}[1]{\textcolor{red}{#1}}
  - \usepackage{fontawesome5}
  - \usepackage{todonotes}
  - \newcommand{\BTheta}{\ifthenelse{\value{bbsym4theta}=1}{\text{\faBasketballBall}}{\mathbf{\Theta}}}
output:
  pdf_document: 
    keep_tex: no
    number_sections: yes
bibliography: bibliography.bib    
editor_options: 
  chunk_output_type: console
---

\newcounter{bbsym4theta}
\setcounter{bbsym4theta}{1}

\begin{abstract}
Nu ved jeg godt nok intet om sport, men... \faBasketballBall!
\end{abstract}

\begin{center}
\textbf{Keywords:} APBRmetrics, Bayesian Statistics, Gaussian Processes, Sports Statistics, Trends
\end{center}

# Introduction

Sports analytics receive increasing attention within statistics and not just for match prediction or betting but also for game evaluation, in-game and post-game coaching purposes, and for setting strategies and tactics in future matches. 

Many popular sports such as football (soccer), basketball, boxing, table tennis, volleyball, American football, and handball involves matches between two teams or players where each team have the possibility of scoring throughout the match. Several research papers seek to predict match results (e.g., @skellam2; @groll2019; @Gu2019) or match winners for single matches (@cattelan2013bradley) in order to infer the match winner and potentially the winner of a tournament (@ekstrom2020trps; @baboota).  While the overall result is highly interesting it conveys very little information about the individual development and trends throughout the match and modeling approaches that allow a finer granularity of the score difference throughout the match is needed.

The trend in score difference between the two teams is a proxy for their underlying strengths. In particular, sustained periods of time where the score difference increases suggests that one team outperforms the other whereas periods where the teams are constantly catching up to each other suggest that the team's strengths in those periods are similar. Modeling the local trend of the score difference will therefore reflect several aspects of the game in particular the team strengths and game dynamics and momentum as they develop through the match.

Figure \ref{fig1} shows the development of the score difference for the final match of the playoffs in the 2020 National Basketball Association (NBA) series between Los Angeles Lakers and Miami Heat. Positive numbers indicate that LA Lakers are leading and the running score difference shows that the Lakers pulled ahead until the third quarter where Miami Heat started to keep up the scoring pace before overtaking the Lakers and reducing the lead.

\begin{figure}[htbp]
\includegraphics{../figures/fig1.pdf}
\caption{Los Angeles Lakers at Miami Heat. October 11, 2020 \textbf{[??? elaborate ???]}}
\label{fig1}
\end{figure}

In this paper we will consider the score difference between two teams as a latent Gaussian process and use the Trend Direction Index (TDI) from @ToT as an accomodating measure to evaluate the local probability of the *monotonicity* of the latent process at a given time point during a match. The Trend Direction Index uses a Bayesian framework to provide a direct answer to questions such as "What is the probability that the latent process (i.e., that one team is doing better than another) is increasing at a given time-point?". This will allow real-time evaluation of the score difference trend at the current time-point in the game and will provide post-game inference about the "hot" periods of a match where one team out-performed the other. Furthermore we will present the Excitement Trend Index (ETI) as an objective measure of spectator excitement in a given match. The ETI is defined as the expected number of times that the score difference changes monotonicity during a match. If the score difference changes monotonicity othen then that echos a game where both teams frequently score that the whereas a game with a low ETI will represent a one-sided match where one team is doing consistently better than the other over sustained periods of time.


Other authors have considered using continuous processes to model the score difference of matches. @gabel2012random shows that NBA basketball score difference is well described by a continuous-time anti-persistent random walk which suggests that a latent Gaussian process might be viable.

* @chen2020rank
* @chen2018functional

The paper is structured as follows. In the next section we introduce trend modeling through latent a Gaussian process and define the Trend Direction Index and Excitement Trend Index that captures the local trends in monotonicity and game excitement, respectively. In Section \ref{sec:application} we apply the our proposed methodology to analyse both the final match of the playoff as well as evaluating the game excitement distribution of the season by considering the ETI from all 1143 matches from the 2019--2020 National Basketball Association (NBA) season. We show how this distribution can be used to assess relative match excitement. We conclude with a discussion in Section \ref{sec:discussion}. Materials to reproduce this manuscript and its analyses can be found at @HavingABall.

Unused stuff for now: 
*Philosophical question: What exactly is the sampling model for a single match?
We could have a motivating figure here -- e.g. a variation of Figure 1 (see its caption).*


# Methods {#sec:method}

Our model is based on the observed score differences $D_m$ in a given match indexed by $m$. For each match we observe the random variables $\mathcal{D}_m = \left(t_{mi}, D_{mi}\right)_{0 < i \leq J_m}$ where $t_{m1} < t_{m2} < t_{mi} < \ldots < t_{m J_m}$ are the ordered time points at which any teams scores, $D_{mi} = D_m(t_{mi})$ is the associated difference in scores at time $t_{mi}$, and $J_m$ is the total number of scorings during the match. We use the convention that $D_m$ is the difference in scores of the away team with respect to the home team, so that $D_m(t) > 0$ means that the away team is leading at time $t$.

We assume that the observed match data from a given match are noisy realizations of a latent smooth, random function defined in continuous time evaluated at the random time points where goals occur. Let $d_m$ be the latent functions from which the realizations $\mathcal{D}_m$ are generated. Our objective is to infer $d_m$ and its time dynamics from $\mathcal{D}_m$. In pursuance of this intention we propose the following hierarchical model where $d_m$ is a Gaussian process defined on a compact subset of the real line $\mathcal{I}_m$ corresponding to the duration of the $m$'th game, and the observed data conditional on the scoring times and the values of the latent process at these times are independently normally distributed random variables with a match specific variance. This model for a given match can be written as
\begin{align}
\begin{split}
  \BTheta_m \mid \bm{\Psi_m}, \mathbf{t}_m &\sim H(\BTheta_m \mid \bm{\Psi}_m)\\
  d_m(t) \mid \BTheta_m &\sim \mathcal{GP}(\mu_{\bm{\beta}_m}(t), C_{\bm{\theta}_m}(s, t))\\
  D_m(t_{mi}) \mid d_m(t_{mi}), t_{mi}, \BTheta_m &\overset{iid}{\sim} N\left(d_m(t_{mi}), \sigma_{m}^2\right)
\end{split}
\label{eq:hierarchicalmodel}
\end{align}
where $\BTheta_m = (\bm{\beta}_m, \bm{\theta}_m, \sigma_{m}^2)$ is a vector of hyper-parameters governing the dynamics of the latent Gaussian process with a prior distribution $H$ indexed by parameters $\bm{\Psi}_m$, and $\mathbf{t}_m = (t_{m1}, \ldots, t_{m J_m})$ is the vector of time points where goals occurs in the match. The functions $\mu_{\bm{\beta}_m}$ on $\mathcal{I}_m$ and $C_{\bm{\theta}_m}$ on $\mathcal{I}_m \times \mathcal{I}_m$ are the prior mean and covariance functions of the latent Gaussian process, and $\sigma_m^2$ is the variance characterizing the magnitudes deviations between for the observed score differences and the values of the latent process.

A Gaussian process is characterized by the multivariate joint normality of all of the joint distributions resulting from evaluating the process at any finite set of time points (@rasmussen2003gaussian). Specifically, for any finite set $\mathbf{t}^\ast \subset \mathcal{I}_m$ it follows that that the vector $d(\mathbf{t}^\ast) \mid \BTheta_m$ is distributed as $N(\mu_{\bm{\beta}_m}(\mathbf{t}^\ast), C_{\bm{\theta}_m}(\mathbf{t}^\ast, \mathbf{t}^\ast))$ where $\mu_{\bm{\beta}_m}(\mathbf{t}^\ast)$ is the vector generated by evaluating the prior mean function $\mu_{\bm{\beta}_m}(t)$ at $\mathbf{t}^\ast$ and $C_{\bm{\theta}_m}(\mathbf{t}^\ast, \mathbf{t}^\ast))$ is the covariance matrix generated by evaluating the prior covariance function $C_{\bm{\theta}_m}(s,t)$ at $\mathbf{t}^\ast \times \mathbf{t}^\ast$. Using the properties of multivariate normal distributions the posterior distribution of $d_m(\mathbf{t}^\ast) \mid \mathcal{D}_m, \BTheta_m$ is also a multivariate normal distribution. This facilitates Bayesian estimation of the distribution of the latent process governing the score difference given the observed data from each match. 

In addition to obtaining inference for the latent process we may also estimate its time dynamics. This follows since a Gaussian process along with its time derivatives (provided they exist) are distributed as a multivariate Gaussian process (@cramer1967stationary). We can therefore augment the model in Equation (\ref{eq:hierarchicalmodel}) with an additional latent structure of the first and second derivatives of $d_m$ with respect to time as
\begin{align}
  \begin{bmatrix}d_m(s)\\ d^{\prime}_m(t)\\ d^{\prime\prime}_m(u)\end{bmatrix} \mid \BTheta_m &\sim \mathcal{GP}\left(\begin{bmatrix}\mu_{\bm{\beta}_m}(s)\\ \mu^{\prime}_{\bm{\beta}_m}(t)\\ \mu^{\prime\prime}_{\bm{\beta}_m}(u)\end{bmatrix}, \begin{bmatrix}C_{\bm{\theta}_m}(s, s^\prime) & \partial_2 C_{\bm{\theta}_m}(s, t) & \partial_2^2 C_{\bm{\theta}_m}(s, u)\\ \partial_1 C_{\bm{\theta}_m}(t, s) & \partial_1 \partial_2 C_{\bm{\theta}_m}(t, t^\prime) & \partial_1 \partial_2^2 C_{\bm{\theta}_m}(t, u)\\ \partial_1^2 C_{\bm{\theta}_m}(u, s) & \partial_1^2\partial_2 C_{\bm{\theta}_m}(u, t) & \partial_1^2 \partial_2^2 C_{\bm{\theta}_m}(u, u^\prime)\end{bmatrix}\right)
\label{eq:dynamics}
\end{align}
where $^\prime$ and $^{\prime\prime}$ denote the first and second time derivatives, $\partial_j^k$ is the $k$'th order partial derivative with respect to the $j$'th variable. Combining the models in Equations (\ref{eq:hierarchicalmodel}) and (\ref{eq:dynamics}) we therefore also have explicit expressions for the posterior distributions $d^\prime_m \mid \mathcal{D}_m, \BTheta_m$ and $d^{\prime \prime}_m \mid \mathcal{D}_m, \BTheta_m$. We use the posteriors of the first and second time derivatives of the latent process to characterize the dynamical properties of each match through the Trend Direction Index (TDI) and the Excitement Trend Index (ETI).

[\textbf{??? Introduce and fix notation for the posteriors and refer to supplementary for explicit expressions ???}]

We define the Trend Direction Index (TDI) of a particular match $m$ as the local posterior probability that $d_m$ is an increasing function at any time in $\mathcal{I}_m$. Under our model this is equal to
\begin{align}
\begin{split}
  \textrm{TDI}_m(t \mid \BTheta_m) &= P\left(d_m^\prime(t) > 0 \mid \mathcal{D}_m, \BTheta_m\right)\\
     &= \frac{1}{2} + \frac{1}{2}\Erf\left(\frac{\mu_{f^\prime}(t \mid \BTheta_m)}{2^{1/2}\Sigma_{f^\prime f^\prime}(t, t \mid \BTheta_m)^{1/2}}\right)
\end{split}
\label{eq:TDIdef}
\end{align}
where $\Erf\colon\, x \mapsto 2\pi^{-1/2}\int_0^x \exp(-u^2)\mathrm{d}u$ is the error function and $\mu_{df}$ and $\Sigma_{df}$ are the posterior mean and covariance of the trend. \textbf{[??? Write out interpretation ???]}

[\textbf{Note that if we change the reference team then TDI is just 1 - TDI so it's symmetric}]

To each match we assign its Excitement Trend Index, denoted by $\text{ETI}_m$, as a global index of excitement. The index is defined as the expected number of changes in monotonicity of the posterior distribution of $d_m$ which is equivalent to the expected number of zero-crossings of the posterior distribution of $d^\prime_m$. We hence define
\begin{align}
\begin{split}
  \text{ETI}_m \mid \BTheta_m &= \E\left[\#\left\{t \in \mathcal{I}_m : d^\prime_m(t) = 0\right\} \mid \mathcal{D}_m, \BTheta_m\right]\\
  &= \int_{\mathcal{I}_m} d\mathrm{ETI}_m(t \mid \BTheta_m)\mathrm{d}t
\end{split}
\label{eq:ETIdef}
\end{align}
where $d\mathrm{ETI}_m$ is the instantaneous posterior probability of a zero-crossing of $d^\prime$ at any time point $t \in \mathcal{I}_m$. Under the model described in Equations (\ref{eq:hierarchicalmodel}) and (\ref{eq:dynamics}) it can be shown that $d\mathrm{ETI}$ is equal to
\begin{align*}
d\mathrm{ETI}_m(t \mid \BTheta_m) = \lambda(t \mid \BTheta_m)\phi\left(\frac{\mu_{df}(t \mid \BTheta_m)}{\Sigma_{df}(t,t \mid \BTheta_m)^{1/2}}\right)\left(2\phi(\zeta(t\mid \BTheta_m)) + \zeta(t\mid \BTheta_m)\Erf\left(\frac{\zeta(t\mid \BTheta_m		)}{2^{1/2}}\right)\right)
\end{align*}
where $\phi\colon\, x \mapsto 2^{-1/2}\pi^{-1/2}\exp(-\frac{1}{2}x^2)$ is the standard normal density function, and $\lambda$, $\omega$ and $\zeta$ are functions defined by		
\begin{align*}
  \lambda(t \mid \BTheta_m) &= \frac{\Sigma_{d^2\!f}(t,t \mid \BTheta_m)^{1/2}}{\Sigma_{df}(t,t \mid \BTheta_m)^{1/2}}\left(1-\omega(t \mid \BTheta_m)^2\right)^{1/2}\\
  \omega(t \mid \BTheta_m) &= \frac{\Sigma_{df,d^2\!f}(t,t \mid \BTheta_m)}{\Sigma_{df}(t,t \mid \BTheta_m)^{1/2}\Sigma_{d^2\!f}(t,t \mid \BTheta_m)^{1/2}}\\
  \zeta(t\mid \BTheta_m) &= \frac{\mu_{df}(t\mid \BTheta_m)\Sigma_{d^2\!f}(t,t\mid \BTheta_m)^{1/2}\omega(t)\Sigma_{df}(t,t\mid \BTheta_m)^{-1/2} - \mu_{d^2\!f}(t\mid \BTheta_m)}{\Sigma_{d^2\!f}(t,t\mid \BTheta_m)^{1/2}\left(1 - \omega(t\mid \BTheta_m)^2\right)^{1/2}}
\end{align*}
A derivation of this expression can be found in the supplementary material to @ToT.

[\textbf{???} We need to argue that ETI for $S_a(t_{m_i}) - S_{b}(t_{m_i})$ is symmetric in $a$ and $b$ so that our choice of "reference group" in $D_m$ is not important. The reason is that we look at both up- and down-crossings at $0$ of $df_m$ so the choice of sign in $D_m$ is not relevant. ??? ]

Both the Trend Direction Index and the Excitement Trend Index in Equations (\ref{eq:TDIdef}) and (\ref{eq:ETIdef}) are random variables due to their dependence on the hyper-parameters $\BTheta_m$. In our Bayesian framework these are specified under an addition layer of prior distributions according to $H(\BTheta_m \mid \bm{\Psi}_m)$. By fitting the model using Markov-Chain Monte Carlo methods (MCMC) we obtain the posterior distribution $\widetilde{\BTheta}_m \sim P(\BTheta_m \mid \mathcal{D}_m, \bm{\Psi}_m, \mathbf{t}_m)$ given by
\begin{align*}
  \widetilde{\BTheta}_m &\sim \frac{H(\BTheta_m \mid \bm{\Psi}_m) \int P(\mathbf{D}_m \mid d_m(\mathbf{t}_m), \BTheta_m, \bm{\Psi}_m, \mathbf{t}_m)dP(d_m(\mathbf{t}_m) \mid \BTheta_m, \bm{\Psi}_m, \mathbf{t}_m)}{\iint P(\mathbf{D}_m \mid d_m(\mathbf{t}_m), \BTheta_m, \bm{\Psi}_m, \mathbf{t}_m)dP(d_m(\mathbf{t}_m) \mid \BTheta_m, \bm{\Psi}_m, \mathbf{t}_m)dH(\BTheta_m \mid \bm{\Psi}_m)}
\end{align*}
and the posterior estimates of TDI and ETI are therefore the random variables $\textrm{TDI}_m(t) \mid \widetilde{\BTheta}_m$ and $\textrm{ETI}_m \mid \widetilde{\BTheta}_m$. \textbf{[??? check notation ???]}

To summarize the posterior distributions of TDI and ETI we one can either use the average value calculated by integrating over the distribution of $\widetilde{\BTheta}_m$ or
\begin{align*}
\overline{\mathrm{TDI}}_m(t) &= \int \BTheta_m \mathrm{TDI}_m(t \mid \widetilde{\BTheta}_m)dP(\widetilde{\BTheta}_m)\\
\overline{\mathrm{TDI}^p}_m(t) &= \sup\left\{\mathrm{TDI}_m(t \mid \widetilde{\BTheta}_m) : \mathrm{TDI}_m(t \mid \widetilde{\BTheta}_m) < p\right\}
\end{align*}
\textbf{[??? and now I go to bed ???]}


## Estimation
To complete the specification of the model in Equation (\ref{eq:hierarchicalmodel}) we need to specify prior mean and covariance functions for the latent process. The choice of these are application specific and can be based on prior knowledge of the game dynamics. We refer to the discussion in @ToT for more information on such choices.

In our application we used a constant prior mean and the squared exponential covariance function given by
\begin{align*}
  \mu_{\bm{\beta}_m}(t) = \beta_m, \quad C_{\bm{\theta}_m}(s, t) = \alpha^2_m\exp\left(-\frac{(s-t)^2}{2\rho^2_m}\right)
\end{align*}
with $\bm{\theta}_m = (\alpha_m, \rho_m) > 0$ and hence $\BTheta_m = (\beta_m,\alpha_m, \rho_m,\sigma^2)$. \textbf{[??? Note: Infinitely differetiable sample paths. Sample path derivatives are well-defined]} For the hyper-parameters of $\BTheta_m$ we used independent, heavy-tailed distribution with a moderate variance centered at the marginal maximum likelihood estimates of the form
\begin{align*}
H(\BTheta_m \mid \bm{\Psi}_m) = H(\beta_m \mid \Psi_{\beta_m})H(\alpha_m \mid \Psi_{\alpha_m})H(\rho_m \mid \Psi_{\rho_m})H(\sigma_m \mid \Psi_{\sigma_m})
\end{align*}
with
\begin{align*}
\beta_{m} \sim T\left(\widehat{\beta_m^\text{ML}}, 3, 3\right), \quad \alpha_m \sim T^+\left(\widehat{\alpha_m^\text{ML}}, 3, 3\right), \quad \rho_m \sim N^+\left(\widehat{\rho_m^\text{ML}}, 1\right), \quad \sigma_m \sim T^+\left(\widehat{\sigma_m^\text{ML}}, 3, 3\right)
\end{align*}
where $T^+(\cdot, \cdot, \mathrm{df})$ and $N^+(\cdot, \cdot)$ denotes the location-scale half T- and normal distribution functions with $\mathrm{df}$ degrees of freedom.  

We have implemented the estimation procedure in the probabilistic programming language Stan [@carpenter2017stan] using Hamiltonian Markov Chain Monte Carlo. For each match we ran four independent Markov chains for 25,000 iterations each with half of the iterations used for warm-up. Convergence was assessed by trace plots of the MCMC draws and the potential scale reduction factor, $\widehat{R}$, of @gelman1992inference.



# Application: The 2019--2020 NBA basketball season {#sec:application}

To show the applicability of our proposed model we will apply it to data from all regular games from the 2019--2020 NBA basketball season (obtained from @BBreference and provided in @HavingABall). A lot of points are scored during a basketball match so it is easy to see the development of the score difference. 

The 2019--2020 NBA season was suspended mid-March because of Covid-19 but it was resumed again in July 2020. There were a total of 1059 regular season matches. The subsequent playoffs comprised 84 matches including thee final for a grand total of 1143 matches. For ease of comparison we are only considering the first 48 regular minutes of each match --- any part of a match that goes into overtime will be disregarded. Thus, $\mathcal{I}_m = [0; 48]$ minutes without overtime.

For each of the 1143 matches during the season we fitted our model, and [\textbf{???}].

\begin{figure}[htbp]
\includegraphics{../figures/fig2.pdf}
\caption{Histogram and kernel density estimate of the distribution of 1143 median posterior Excitement Trend Indices from the NBA 2019--2020 season (left panel) and the median posterios ETIs as a function of calender time from October 22, 2019 to October 11, 2020 (right panel).}
\label{fig2}
\end{figure}

The left panel of Figure \ref{fig2} shows the distribution of the median posterior Excitement Trend Indices estimated using our model for each of the 1143 games in the 2019--2020 NBA season. The distribution of game excitements is right skewed (skewness = 0.53) with a range of $[0.23; 26.28]$, and an median of 10.09 (mean = 10.62, SD = 4.52). This implies that the time-varying score differences of the games in the season changes monotonicity approximately 10 times during a game on average. The right panel of the same figure shows the values of the median posterior ETIs as a function of the calendar time were the matches were played. Besides illustrating the gap from the Covid-19 hiatus, the figure shows that the excitement indices are relatively evenly distributed throughout the season.

Summarizing the posterior median ETIs at the team level lead to comparable values across all 30 teams. The New Orleans Pelicans had the highest average posterior median ETI during the season with a value of 11.67 (SD = 4.91, IQR = $[3.09; 23.57]$), while the Charlotte Hornets had the lowest average posterior median ETI during the season with a value of 9.29 (SD = 3.74, IQR = $[1.96; 15.98]$). This implies that each team played games during the season that where comparable on average in terms their excitement, and the major source of variation in excitement is governed by the individual matches. The supplementary material to this paper provides summary statistics for all 30 teams.

The asymmetry of the distribution of the Excitement Trend Indices in Figure \ref{fig2} conjectures the possibility of a latent, categorical variable labeling the matches to different classes. We thus fitted a heteroscedastic Gaussian mixture model to the median posterior Excitement Trend Indices on the match level, where the number of latent classes was determined by a bootstrapped likelihood ratio test using 10,000 bootstrap replicates (@mclust). Testing for 1 vs 2 latent classes gave a p-value of $< 0.001$, 2 vs 3 gave a p-value of $0.027$, 3 vs 4 gave a p-value of $0.008$, and 4 vs 5 gave a p-value of $0.300$ implying that the distribution of median posterior Excitement Trend Indices can be modeled by a 4-component Gaussian mixture distribution. The following table shows the maximum likelihood estimates of the parameters of the Gaussian mixture model.

|           | class 1| class 2| class 3| class 4|
|:----------|-------:|-------:|-------:|-------:|
|$\pi$      |    0.24|    0.22|    0.28|    0.26|
|$\mu$      |    5.70|    8.89|   12.64|   14.45|
|$\sigma^2$ |    4.44|    1.87|    5.15|   23.31|

Figure \ref{fig2-5} shows the estimated Gaussian mixture model along with the histogram (left panel), and the proportion of matches classified into the four latent classes as determined by a maximum posterior decision rule (right panel). 

[\textbf{So we basically have a group of average matches (class 2), a group below average (class 1), a group above average (class 3) and then also group of 150 matches with an even large average but also a larger variance (class 4). Can we say something about these classes?}]

\begin{figure}[htbp]
\includegraphics{../figures/fig2-5.pdf}
\caption{}
\label{fig2-5}
\end{figure}



Figure \ref{fig3} shows ...


# Discussion {#sec:discussion}

Some summarization goes on here. We have introduced etc...

We could define a weighted Excitement Trend Index, $\mathrm{WETI}_m$, so that changes in monotonicity of the score differences are i) weighted higher towards the end of the game and ii) weighted lower if one team is already far away of the other team. This motivates a weighted ETI of the form
\begin{align*}
  \mathrm{WETI}_m\mid \BTheta_m = \int_{\mathcal{I}_m} w(t, |d_m(t)|)d\mathrm{ETI}_m(t \mid \BTheta_m)\mathrm{d}t
\end{align*}
where $w$ is a bivariate weight function being increasing in its first variable and decreasing in its second variable. Such weight function could be constructed as a product of two kernel functions on $[0;48] \times \mathbb{R}_{\geq 0}$ with bandwidths based on studies of psychological perception.

A different approach would be to define team-specific excitement index nested with a match. Here we would only look at the **up**-crossings at zero of $df_m$ and we would get two excitement indices for each match $(\mathrm{ETI}_{am}, \mathrm{ETI}_{bm})$. for teams $a$ and $b$. This would somehow reflect how exciting each team were in match $m$ with respect to chancing the sign of the score differences in their favor.


# Acknowledgements {-}

# Bibliography {-}

<div id="refs"></div>


\newpage

\begin{figure}[htbp]
\includegraphics{../figures/fig3.pdf}
\caption{Observed score differences with posteriors of the latent processes (left panels), posterior trends (middle panels) and posterior Trend Direction Indices (right panels) for five games from the NBA season 2019--2020 with median posterior Excitement Trend Indices corresponding to the 0\%, 25\%, 50\%, 75\%, and 100\% percentiles of the distribution of all games in the season. Gray regions depict 50\%, 95\%, and 99\% point-wise credible intervals.}
\label{fig3}
\end{figure}
